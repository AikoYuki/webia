name: Deploy Website via FTP # 1. El nombre del workflow

on: # 2. CUÁNDO se dispara el workflow (cada vez que haces push a la rama 'main')
  push:
    branches:
      - main 

jobs: # 3. Los trabajos a ejecutar
  ftp-deploy: # Nombre del trabajo (job)
    runs-on: ubuntu-latest
    steps:
      # Paso 1: Checkout - Descarga el código del repositorio
      - uses: actions/checkout@v4 
      
      # Paso 2: FTP Deploy - El bloque que ya tenías, pero correctamente anidado
      - name: FTP Deploy Action via lftp (FTP, SFTP, FTPS)
        uses: pontago/lftp-deploy-action@v1.0.1
        with:
          # Server Hostname or IP
          host: ${{ secrets.FTP_HOST }}
          # Login Username
          username: ${{ secrets.FTP_USERNAME }}
          # Login Password
          password: ${{ secrets.FTP_PASSWORD }}
          # Default port are FTP(21), SFTP(22).
          port: 21
          # Transfer protocol (ftp, ftps, sftp)
          protocol: ftp
          # Upload source directory.
          local_dir: ./
          # Upload remote directory.
          remote_dir: /htdocs/ # Confirma que esta sea la ruta de InfinityFree
          # If doesn't exists, create remote directory.
          create_remote_dir: true

          # Si es estrictamente necesario definir el script (que parece ser el caso):
          script: "" 
          # dry_run: # Si quieres probarlo antes de subir, descomenta y pon 'true'
          # debug: true # Descomenta esto solo si sigue fallando para obtener logs detallados
